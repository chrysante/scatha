// No include guards

// ===----------------------------------------------------------------------===
// === CFG -----------------------------------------------------------------===
// ===----------------------------------------------------------------------===

#ifndef SC_MIR_CFGNODE_DEF
#   define SC_MIR_CFGNODE_DEF(node, _)
#endif

SC_MIR_CFGNODE_DEF(Value,               ABSTRACT)
SC_MIR_CFGNODE_DEF(Register,            ABSTRACT)
SC_MIR_CFGNODE_DEF(SSARegister,         CONCRETE)
SC_MIR_CFGNODE_DEF(VirtualRegister,     CONCRETE)
SC_MIR_CFGNODE_DEF(CalleeRegister,      CONCRETE)
SC_MIR_CFGNODE_DEF(HardwareRegister,    CONCRETE)
SC_MIR_CFGNODE_DEF(Constant,            CONCRETE)
SC_MIR_CFGNODE_DEF(UndefValue,          CONCRETE)
SC_MIR_CFGNODE_DEF(BasicBlock,          CONCRETE)
SC_MIR_CFGNODE_DEF(Function,            CONCRETE)

#undef SC_MIR_CFGNODE_DEF

// ===----------------------------------------------------------------------===
// === Instructions --------------------------------------------------------===
// ===----------------------------------------------------------------------===

#ifndef SC_MIR_INSTRUCTION_DEF
#   define SC_MIR_INSTRUCTION_DEF(node, name)
#endif

SC_MIR_INSTRUCTION_DEF(Store,           "store")      // (<Ptr> dest, Value source) [Data[0] = const-ptr-data]
SC_MIR_INSTRUCTION_DEF(Load,            "load")       // (<Ptr> source)             [Data[0] = const-ptr-data]
SC_MIR_INSTRUCTION_DEF(Copy,            "copy")       // (Value source)
SC_MIR_INSTRUCTION_DEF(Call,            "call")       // (Value callee)             [Data[0] = CallInstData,
                                                      //                             Data[1] = { bool is-memory-call, const-ptr-data }]
SC_MIR_INSTRUCTION_DEF(CallExt,         "callext")    // ()                         [Data[0] = CallInstData]
SC_MIR_INSTRUCTION_DEF(CondCopy,        "<cond-cpy>") // (Value source)             [Data[0] = condition]

SC_MIR_INSTRUCTION_DEF(LIncSP,          "incsp")      // (Constant numBytes)
SC_MIR_INSTRUCTION_DEF(LEA,             "lea")        // (<Ptr> address)            [Data[0] = const-ptr-data]
SC_MIR_INSTRUCTION_DEF(LDA,             "lda")        // (Value offset)
SC_MIR_INSTRUCTION_DEF(Compare,         "<compare>")  // (Value lhs, Value rhs)     [Data[0] = mode]
SC_MIR_INSTRUCTION_DEF(Test,            "<test>")     // (Value operand)            [Data[0] = mode]
SC_MIR_INSTRUCTION_DEF(Set,             "<set-inst>") // ()                         [Data[0] = condition]
SC_MIR_INSTRUCTION_DEF(UnaryArithmetic, "<un-arith>") // (Value operand)            [Data[0] = operation]
SC_MIR_INSTRUCTION_DEF(Arithmetic,      "<arith>")    // (Value lhs, Value rhs)     [Data[0] = operation]
SC_MIR_INSTRUCTION_DEF(Conversion,      "<conv>")     // (Register operand)         [Data[0] = conversion]
SC_MIR_INSTRUCTION_DEF(Jump,            "jmp")        // (BasicBlock target)
SC_MIR_INSTRUCTION_DEF(CondJump,        "<cond-jmp>") // (BasicBlock target)        [Data[0] = condition]
SC_MIR_INSTRUCTION_DEF(Return,          "ret")        // ()
SC_MIR_INSTRUCTION_DEF(Phi,             "phi")        // (Value...) // One Value entry per predecessor
SC_MIR_INSTRUCTION_DEF(Select,          "sel")        // (Value, Value)             [Data[0] = condition] // Condition to take first value

#undef SC_MIR_INSTRUCTION_DEF

// ===----------------------------------------------------------------------===
// === Instruction classes -------------------------------------------------===
// ===----------------------------------------------------------------------===

#ifndef SC_MIR_INSTCLASS_DEF
#   define SC_MIR_INSTCLASS_DEF(node, _)
#endif

SC_MIR_INSTCLASS_DEF(Instruction,     ABSTRACT)

SC_MIR_INSTCLASS_DEF(StoreInst,           CONCRETE)
SC_MIR_INSTCLASS_DEF(LoadInst,            CONCRETE)
SC_MIR_INSTCLASS_DEF(CopyInst,            CONCRETE)
SC_MIR_INSTCLASS_DEF(CallBase,            ABSTRACT)
SC_MIR_INSTCLASS_DEF(CallInst,            CONCRETE)
SC_MIR_INSTCLASS_DEF(CallExtInst,         CONCRETE)
SC_MIR_INSTCLASS_DEF(CondCopyInst,        CONCRETE)
SC_MIR_INSTCLASS_DEF(LISPInst,            CONCRETE)
SC_MIR_INSTCLASS_DEF(LEAInst,             CONCRETE)
SC_MIR_INSTCLASS_DEF(CompareInst,         CONCRETE)
SC_MIR_INSTCLASS_DEF(TestInst,            CONCRETE)
SC_MIR_INSTCLASS_DEF(SetInst,             CONCRETE)
SC_MIR_INSTCLASS_DEF(UnaryArithmeticInst, CONCRETE)
SC_MIR_INSTCLASS_DEF(ArithmeticInst,      ABSTRACT)
SC_MIR_INSTCLASS_DEF(ValueArithmeticInst, CONCRETE)
SC_MIR_INSTCLASS_DEF(LoadArithmeticInst,  CONCRETE)
SC_MIR_INSTCLASS_DEF(ConversionInst,      CONCRETE)
SC_MIR_INSTCLASS_DEF(TerminatorInst,      ABSTRACT)
SC_MIR_INSTCLASS_DEF(JumpBase,            ABSTRACT)
SC_MIR_INSTCLASS_DEF(JumpInst,            CONCRETE)
SC_MIR_INSTCLASS_DEF(CondJumpInst,        CONCRETE)
SC_MIR_INSTCLASS_DEF(ReturnInst,          CONCRETE)
SC_MIR_INSTCLASS_DEF(PhiInst,             CONCRETE)
SC_MIR_INSTCLASS_DEF(SelectInst,          CONCRETE)

#undef SC_MIR_INSTCLASS_DEF
